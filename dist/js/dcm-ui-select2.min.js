"use strict";angular.module("dcm-ui.select2",[]),angular.module("dcm-ui.select2").constant("SELECT2",{events:{close:"CLOSE_SELECT2"}}).directive("dcmSelect2",["$q","$filter","$parse","SELECT2",function(e,n,t,a){return{restrict:"A",replace:!1,require:"ngModel",scope:!1,transclude:!1,compile:function(n){if(!n.is("input[type=hidden]"))throw'only <input type="hidden"> tags can have this attribute';return function(n,o,r,l){var i,u,c=r.idField||"id",s=r.textField||"text",d=r.iconField||"icon",p=r.modelSelected?t(r.modelSelected).assign:angular.noop,g=t(r.ngModel).assign,m=r.selectedOptGroup?t(r.selectedOptGroup).assign:angular.noop,f=r.selectedOptGroup?t(r.selectedOptGroup):angular.noop,h=r.optGroupIdField||"id",v={},y=function(){if(void 0===u){var e=t(r.data)(n);angular.isFunction(e)?(i=e(),u=!0):u=!1}return u?i:t(r.data)(n)},w=function(e){var n=[];return angular.forEach(e,function(e){e.hasOwnProperty(c)&&n.push(e),e.hasOwnProperty("children")&&angular.isArray(e.children)&&e.children.length&&n.push.apply(n,e.children)}),n},b=function(e,t){var a={objectData:null,idData:""},o=w(e);if(v.multiple){t=t?t:[];var r=[],l=[],i={};return angular.forEach(t,function(e){i[e.toString()]=!0}),angular.forEach(o,function(e){i.hasOwnProperty(e[c].toString())&&(r.push(e[c]),l.push(e))}),a.objectData=l,a.idData=r,a}return t=t?t:"",angular.forEach(o,function(e){return e[c].toString()===t.toString()?(m(n,e[h]),a.objectData=e,void(a.idData=t)):void 0}),a},$=function(e){return e?angular.isArray(e)&&0===e.length?!0:!1:!0},x={dropdownAutoWidth:!1,width:"off",query:function(t){e.when(y()).then(function(e){var a=[];if(e||(e=[]),t.term&&""!==t.term){var o=t.term.toLowerCase();angular.forEach(e,function(e){var n=angular.copy(e),t=!1,r=n.children;n.children=[],-1!==n[s].toString().toLowerCase().indexOf(o)&&(t=!0),r&&angular.isArray(r)&&angular.forEach(r,function(e){-1!==e[s].toString().toLowerCase().indexOf(o)&&(t=!0,n.children.push(e))}),t&&a.push(n)})}else a=e.slice(0);var r=f(n);if(r){var l={};l[h]=r;var i=_.findWhere(a,l);if(i){var u=_.indexOf(a,i);a.splice(u,1),a.splice(0,0,i)}}t.callback({more:!1,results:a})})},formatResult:function(e,n,t,a){var o=[];window.Select2.util.markMatch(e[s],t.term,o,a);var r=o.join("");return e[d]&&(r='<i class="select2-inline-icon '+e[d]+'"></i> '+r),r},formatSelection:function(e,n,t){var a=t(e[s]);return e[d]&&(a='<i class="select2-inline-icon '+e[d]+'"></i> '+a),a},id:function(e){return e[c]},initSelection:function(t,a){var o=n.$eval(r.ngModel);e.when(y()).then(function(e){var t=b(e,o);a(t.objectData),p(n,t.objectData),$(t.idData)&&g(n,t.idData)})},formatSearching:function(){return"Loading..."}};angular.extend(v,x,n.$eval(r.dcmSelect2)),o.select2(v),n.$watch(t(r.dcmSelect2),function(e,n){e&&e!==n&&(angular.extend(v,e),o.select2(v))}),o.on("change",function(e){n.$apply(function(){l.$setViewValue(e.val),g(n,e.val),p(n,o.select2("data"))})}),r.$observe("disabled",function(e){o.select2("enable",!e)}),r.$observe("readonly",function(e){o.select2("readonly",!!e)}),n.$watch(t(r.ngModel),function(e){if($(e)){var t=v.multiple?[]:"",a=v.multiple?[]:null;angular.equals(e,t)||g(n,t),o.select2("data",a,!1),p(n,a)}else o.select2("val",e,!1)}),r.modelSelected&&n.$watch(t(r.modelSelected),function(e){if(!angular.equals(e,o.select2("data"))){o.select2("data",e,!1);var t=o.select2("val");g(n,t)}}),n.$watchCollection(y,function(t){var a=o.select2("val");$(a)||e.when(t).then(function(e){var t,r=a;t=b(e,r),angular.equals(a,t.idData)||(o.select2("data",t.objectData,!1),p(n,t.objectData),g(n,t.idData))})}),n.$on("$destroy",function(){o.select2("destroy")}),n.$on(a.events.close,function(){o.select2("close")})}}}}]);
//# sourceMappingURL=dcm-ui-select2.min.js.map